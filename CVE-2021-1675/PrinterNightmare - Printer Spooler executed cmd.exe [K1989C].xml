<?xml version="1.0" encoding="utf-8"?>
<rule>
    <definition>
        <parentprocess>
            <operator type="AND">
                <condition component="FileItem" property="Path" condition="is" value="%SYSTEM%\" />
                <condition component="FileItem" property="FileNameWithoutExtension" condition="is" value="spoolsv" />
                <condition component="ProcessInfo" property="ProcessOwner" condition="is" value="nt authority\system" />
            </operator>
        </parentprocess>
        <process>
            <condition component="FileItem" property="FileNameWithoutExtension" condition="is" value="cmd" />
        </process>
    </definition>
    <description>
        <name>PrinterNightmare - Printer Spooler executed cmd.exe [K1989C]</name>
        <explanation>
            This rule detects the potential exploitation of CVE-2021-1675 (PrinterNightmare). Specifically, spoolsv.exe spawning cmd.exe as a child process.
        </explanation>
        <maliciousCauses>
            An attacker may be attempting to gain access to the system by exploiting CVE-2021-1675.
        </maliciousCauses>
        <benignCauses>
            No benign causes have been found yet.
        </benignCauses>
        <category>
            Exploitation
        </category>
        <severity>80</severity>
    </description>
</rule>